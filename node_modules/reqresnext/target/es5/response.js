"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.ResOptions=exports.DEFAULT_STATUS_CODE=exports.DEFAULT_REQ=exports.DEFAULT_HEADERS=exports.DEFAULT_COOKIES=void 0;var _express=_interopRequireDefault(require("express")),_util=require("./util"),_app=_interopRequireDefault(require("./app"));function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),Object.defineProperty(a,"prototype",{writable:!1}),a}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var response=_express.default.response,DEFAULT_STATUS_CODE=200;exports.DEFAULT_STATUS_CODE=DEFAULT_STATUS_CODE;var DEFAULT_HEADERS={};exports.DEFAULT_HEADERS=DEFAULT_HEADERS;var DEFAULT_COOKIES={};exports.DEFAULT_COOKIES=DEFAULT_COOKIES;var DEFAULT_REQ={};exports.DEFAULT_REQ=DEFAULT_REQ;var Response=_createClass(function b(a){var c=this;_classCallCheck(this,b),(0,_util.setprototypeof)(this,response);var d,e=new ResOptions(a||{});Object.defineProperty(this,"body",{get:function get(){return d},set:function set(){throw new Error("Use .send(), .write() or .json()")}});var f=this.write.bind(this);this.write=function(a,b,e){return(0,_util.isBuffer)(a)?d=(0,_util.concat)(d,a.toString(b)):(0,_util.isString)(a)&&(d=(0,_util.concat)(d,a)),void 0!==a&&f(a,b,e),c},this.end=function(a,b){return c.write(a,b),c.emit("finish"),c},this._headers=null,this.req=e.req,this.app=e.app,this.status(e.statusCode),this.header(e.headers),(0,_util.each)(e.cookies,function(a){var b=a.name,d=a.value,e=a.options;return c.cookie(b,d,e)}),(0,_util.appendAdditionalProps)(this,e.raw)});exports.default=Response;var ResOptions=_createClass(function b(a){_classCallCheck(this,b),this.raw=a,this.statusCode=0|(a.statusCode||a.status||DEFAULT_STATUS_CODE),this.headers=(0,_util.assign)({},DEFAULT_HEADERS,a.headers||{}),this.cookies=(0,_util.assign)({},DEFAULT_COOKIES,a.cookies||{}),this.app=a.app||_app.default,this.req=a.req||DEFAULT_REQ});exports.ResOptions=ResOptions;